import{P as d,k as u,m as g}from"./chunk-MWYAYKLC.js";import{J as l,M as o,pb as m}from"./chunk-6X42ZUM2.js";var h={Whatsapp:"whatsapp",Mail:"mail",Phone:"phone",Web:"web"};var f=(()=>{let r=class r extends u{constructor(e){super(e),this._httpClient=e}};r.\u0275fac=function(s){return new(s||r)(o(m))},r.\u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"});let a=r;return a})();var P=(()=>{let r=class r extends f{constructor(e,s,i){super(e),this._httpClient=e,this._iuService=s,this._contactService=i,this.nameSpace="auth",s.onAccountStatusChange().subscribe(t=>{this.getRoles().then(n=>{t.roles=n})})}newUser(){return{id:"",name:"",lastName:"",email:"",image:"",contacts:[]}}newLogin(){return{email:"",password:""}}newRegister(){return{email:"",name:"",lastName:"",password:""}}httpClient(){}initRegister(e){return new Promise((s,i)=>{this._httpClient.post(this.getBaseUrlNameSpace()+"no-auth/register",e).subscribe(t=>{s(t)},t=>{i({statusCode:500,message:t})})})}login(e){return new Promise((s,i)=>{this._httpClient.post(this.getBaseUrlNameSpace()+"no-auth/login",e).subscribe(t=>{s(t)},t=>{i(t)})})}validateMail(e,s){return new Promise((i,t)=>{let n={email:e,token:s};this._httpClient.post(this.getBaseUrlNameSpace()+"no-auth/confirm-email",n).subscribe(c=>{i(c)},c=>{t(c)})})}rememberUser(e,s,i){let t={userName:e,token:s,roles:[]};console.log(t),localStorage.setItem("auth",JSON.stringify(t)),this._iuService.loadAuthentication()}logOut(){localStorage.removeItem("auth"),this._iuService.clearAuth()}requestResetPassword(e){return new Promise((s,i)=>{this._httpClient.post(this.getBaseUrlNameSpace()+"no-auth/request-reset-password",{email:e}).subscribe(t=>{s(t)},t=>{i(t)})})}changePassword(e,s,i){return new Promise((t,n)=>{let c={email:e,token:s,newPassword:i};this._httpClient.post(this.getBaseUrlNameSpace()+"no-auth/change-password",c).subscribe(p=>{t(p)},p=>{n(p)})})}getById(e){return new Promise((s,i)=>{this._httpClient.get(this.getBaseUrlNameSpace()+""+e).subscribe(t=>{s(t)},t=>{i({statusCode:500,message:t})})})}getByUserEmail(e){return new Promise((s,i)=>{this._httpClient.get(this.getBaseUrlNameSpace()+"byemail/"+e).subscribe(t=>{s(t)},t=>{i({statusCode:500,message:t})})})}getRoles(){return new Promise((e,s)=>{this._httpClient.get(this.getBaseUrlNameSpace()+"roles").subscribe(i=>{e(i.data)},i=>{s("")})})}updateUser(e){return new Promise((s,i)=>{this._httpClient.put(this.getBaseUrlNameSpace(),e).subscribe(t=>{s(t)},t=>{i({statusCode:500,message:t})})})}addWhatsappContact(e,s){e.contacts||(e.contacts=[]);let i=e.contacts.find(t=>t.type===h.Whatsapp);i?!s||s===""?e.contacts=e.contacts.filter(t=>t!=i):i.contact=s:s&&s!==""&&(i=this._contactService.new(),i.type=h.Whatsapp,i.contact=s,e.contacts.push(i))}};r.\u0275fac=function(s){return new(s||r)(o(m),o(g),o(d))},r.\u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"});let a=r;return a})();export{h as a,P as b};
